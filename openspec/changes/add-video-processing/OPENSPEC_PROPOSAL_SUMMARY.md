# OpenSpec ææ¡ˆå·²åˆ›å»º âœ…

## ğŸ“‹ ææ¡ˆæ¦‚è§ˆ

**Change ID**: `add-video-processing`  
**çŠ¶æ€**: âœ… éªŒè¯é€šè¿‡ (openspec validate --strict)  
**ä½ç½®**: `openspec/changes/add-video-processing/`

## ğŸ“ ææ¡ˆæ–‡ä»¶ç»“æ„

```
openspec/changes/add-video-processing/
â”œâ”€â”€ proposal.md                              # ææ¡ˆè¯´æ˜ï¼ˆä¸ºä»€ä¹ˆã€æ”¹ä»€ä¹ˆã€å½±å“ï¼‰
â”œâ”€â”€ tasks.md                                 # å®æ–½ä»»åŠ¡æ¸…å•ï¼ˆ10ä¸ªé˜¶æ®µï¼Œ60+å­ä»»åŠ¡ï¼‰
â”œâ”€â”€ design.md                                # æŠ€æœ¯è®¾è®¡æ–‡æ¡£
â””â”€â”€ specs/
    â””â”€â”€ video-processing/
        â””â”€â”€ spec.md                          # è§„æ ¼å¢é‡ï¼ˆ17ä¸ªéœ€æ±‚ï¼Œ40+åœºæ™¯ï¼‰
```

## ğŸ“ ææ¡ˆå†…å®¹

### Why (ä¸ºä»€ä¹ˆ)
å½“å‰ç³»ç»Ÿç¼ºå°‘è§†é¢‘å†…å®¹ç®¡ç†èƒ½åŠ›ã€‚ç”¨æˆ·éœ€è¦ä¸Šä¼ è‹±è¯­å­¦ä¹ è§†é¢‘ï¼Œå¹¶è‡ªåŠ¨ç”Ÿæˆå­—å¹•ã€ç¿»è¯‘ã€éŸ³æ ‡å’Œè¯­æ³•åˆ†æï¼Œä»¥ä¾¿åˆ›å»ºé«˜è´¨é‡çš„å­¦ä¹ ææ–™ã€‚

### What Changes (æ”¹ä»€ä¹ˆ)
- âœ… è§†é¢‘ä¸Šä¼ å’Œå­˜å‚¨
- âœ… FFmpeg éŸ³é¢‘æå–
- âœ… OpenAI Whisper å­—å¹•ç”Ÿæˆ
- âœ… å­—å¹•ç¿»è¯‘ã€éŸ³æ ‡ã€è¯­æ³•åˆ†æ
- âœ… å­—å¹•ç¼–è¾‘å’ŒæŸ¥è¯¢ API
- âœ… Celery å¼‚æ­¥ä»»åŠ¡å¤„ç†
- âœ… å¤„ç†è¿›åº¦è¿½è¸ª

### Impact (å½±å“)
- **æ–°å¢èƒ½åŠ›**: `video-processing`
- **æ•°æ®åº“è¡¨**: videos, subtitles, grammar_analysis, processing_tasks
- **API è·¯ç”±**: /api/v1/videos/*
- **æ–°å¢ä¾èµ–**: ffmpeg-python, srt, aiofiles, FFmpeg

## ğŸ¯ æ ¸å¿ƒéœ€æ±‚ (17ä¸ª)

1. **Video Upload** - è§†é¢‘ä¸Šä¼ 
2. **Audio Extraction** - éŸ³é¢‘æå–
3. **Subtitle Generation** - å­—å¹•ç”Ÿæˆ
4. **Subtitle Translation** - å­—å¹•ç¿»è¯‘
5. **Phonetic Notation** - éŸ³æ ‡æ ‡æ³¨
6. **Grammar Analysis** - è¯­æ³•åˆ†æ
7. **Subtitle Editing** - å­—å¹•ç¼–è¾‘
8. **Processing Status Query** - çŠ¶æ€æŸ¥è¯¢
9. **Video List Query** - è§†é¢‘åˆ—è¡¨
10. **Subtitle List Query** - å­—å¹•åˆ—è¡¨
11. **Video Deletion** - è§†é¢‘åˆ é™¤
12. **Video Reprocessing** - é‡æ–°å¤„ç†
13. **Asynchronous Task Processing** - å¼‚æ­¥ä»»åŠ¡
14. **Concurrent Processing Limit** - å¹¶å‘é™åˆ¶
15. **Error Handling and Logging** - é”™è¯¯å¤„ç†
16. **File Storage Organization** - æ–‡ä»¶ç»„ç»‡

æ¯ä¸ªéœ€æ±‚éƒ½åŒ…å«è¯¦ç»†çš„åœºæ™¯ï¼ˆScenariosï¼‰æè¿°ã€‚

## ğŸ”§ æŠ€æœ¯å†³ç­–

### å·²ç¡®è®¤çš„æŠ€æœ¯é€‰å‹
- **æ•°æ®åº“**: PostgreSQL âœ…
- **æ–‡ä»¶å­˜å‚¨**: æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ âœ…
- **è§†é¢‘è½¬ç **: ä¸è½¬ç  âœ…
- **å¼‚æ­¥å¤„ç†**: Celery + Redis
- **å­—å¹•ç”Ÿæˆ**: OpenAI Whisper API
- **å†…å®¹å¢å¼º**: OpenAI GPT-4 API

### å…³é”®è®¾è®¡å†³ç­–
1. ä½¿ç”¨ Celery è¿›è¡Œå¼‚æ­¥å¤„ç†
2. ä½¿ç”¨ OpenAI Whisper APIï¼ˆè€Œéæœ¬åœ°æ¨¡å‹ï¼‰
3. PostgreSQL å…³ç³»å‹å­˜å‚¨
4. æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨
5. é€å¥å¤„ç†ï¼Œæ‰¹é‡ä¿å­˜ç­–ç•¥
6. æŒ‡æ•°é€€é¿é‡è¯•æœºåˆ¶

## ğŸ“Š å®æ–½è®¡åˆ’

### 10ä¸ªä¸»è¦é˜¶æ®µ

1. **æ•°æ®åº“è®¾è®¡å’Œè¿ç§»** (6ä¸ªä»»åŠ¡)
2. **æ–‡ä»¶å­˜å‚¨å’Œå¤„ç†** (5ä¸ªä»»åŠ¡)
3. **OpenAI é›†æˆ** (5ä¸ªä»»åŠ¡)
4. **å¼‚æ­¥ä»»åŠ¡å¤„ç†** (5ä¸ªä»»åŠ¡)
5. **API ç«¯ç‚¹å®ç°** (10ä¸ªä»»åŠ¡)
6. **Pydantic æ¨¡å‹** (4ä¸ªä»»åŠ¡)
7. **æœåŠ¡å±‚å®ç°** (4ä¸ªä»»åŠ¡)
8. **é…ç½®å’Œç¯å¢ƒ** (4ä¸ªä»»åŠ¡)
9. **æµ‹è¯•** (6ä¸ªä»»åŠ¡)
10. **æ–‡æ¡£å’Œéƒ¨ç½²** (4ä¸ªä»»åŠ¡)

**æ€»è®¡**: 60+ å­ä»»åŠ¡

### é¢„è®¡æ—¶é—´
- å¼€å‘: 7-12 å¤©
- æµ‹è¯•: 2-3 å¤©
- **æ€»è®¡**: 9-15 å¤©

## ğŸ¨ API è®¾è®¡

### 8ä¸ªæ ¸å¿ƒç«¯ç‚¹

| æ–¹æ³• | ç«¯ç‚¹ | åŠŸèƒ½ |
|------|------|------|
| POST | `/api/v1/videos/upload` | ä¸Šä¼ è§†é¢‘ |
| GET | `/api/v1/videos` | è·å–è§†é¢‘åˆ—è¡¨ |
| GET | `/api/v1/videos/{id}` | è·å–è§†é¢‘è¯¦æƒ… |
| GET | `/api/v1/videos/{id}/status` | æŸ¥è¯¢å¤„ç†çŠ¶æ€ |
| GET | `/api/v1/videos/{id}/subtitles` | è·å–å­—å¹•åˆ—è¡¨ |
| PUT | `/api/v1/subtitles/{id}` | ç¼–è¾‘å­—å¹• |
| DELETE | `/api/v1/videos/{id}` | åˆ é™¤è§†é¢‘ |
| POST | `/api/v1/videos/{id}/reprocess` | é‡æ–°å¤„ç† |

## ğŸ“ˆ æ€§èƒ½é¢„æœŸ

**ç¤ºä¾‹**: 10åˆ†é’Ÿè§†é¢‘ï¼Œçº¦50å¥å­—å¹•

- éŸ³é¢‘æå–: ~2ç§’
- å­—å¹•ç”Ÿæˆ: ~10ç§’ (Whisper API)
- ç¿»è¯‘: ~25ç§’ (50å¥ Ã— 0.5ç§’)
- éŸ³æ ‡: ~25ç§’ (50å¥ Ã— 0.5ç§’)
- è¯­æ³•åˆ†æ: ~50ç§’ (50å¥ Ã— 1ç§’)
- **æ€»è®¡**: ~2-3åˆ†é’Ÿ

## âš ï¸ é£é™©å’Œç¼“è§£

### ä¸»è¦é£é™©
1. **OpenAI API é™æµ** â†’ é™åˆ¶å¹¶å‘æ•°ã€å®ç°é‡è¯•
2. **ç£ç›˜ç©ºé—´ä¸è¶³** â†’ ç›‘æ§ã€å®šæœŸæ¸…ç†
3. **å¤„ç†å¤±è´¥æ¢å¤** â†’ æŒä¹…åŒ–é˜Ÿåˆ—ã€æ”¯æŒé‡æ–°å¤„ç†
4. **æˆæœ¬æ§åˆ¶** â†’ ä½¿ç”¨é‡ç›‘æ§ã€é¢„ç®—å‘Šè­¦

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **ææ¡ˆ**: `openspec/changes/add-video-processing/proposal.md`
- **ä»»åŠ¡æ¸…å•**: `openspec/changes/add-video-processing/tasks.md`
- **è®¾è®¡æ–‡æ¡£**: `openspec/changes/add-video-processing/design.md`
- **è§„æ ¼è¯´æ˜**: `openspec/changes/add-video-processing/specs/video-processing/spec.md`

## âœ… ä¸‹ä¸€æ­¥

1. **å®¡é˜…ææ¡ˆ** - è¯·æ‚¨å®¡é˜…ä»¥ä¸Šæ–‡æ¡£
2. **ç¡®è®¤æ‰¹å‡†** - ç¡®è®¤åæˆ‘å°†å¼€å§‹å®æ–½
3. **å¼€å§‹å®æ–½** - æŒ‰ç…§ tasks.md é€æ­¥å®ç°
4. **æµ‹è¯•éªŒè¯** - å®Œæˆåè¿›è¡Œæµ‹è¯•
5. **å½’æ¡£ææ¡ˆ** - éƒ¨ç½²åä½¿ç”¨ `openspec archive add-video-processing`

## ğŸ” æŸ¥çœ‹ææ¡ˆ

```bash
# æŸ¥çœ‹ææ¡ˆæ¦‚è§ˆ
openspec show add-video-processing

# æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ï¼ˆJSONæ ¼å¼ï¼‰
openspec show add-video-processing --json

# æŸ¥çœ‹è§„æ ¼å¢é‡
openspec show add-video-processing --json --deltas-only

# éªŒè¯ææ¡ˆ
openspec validate add-video-processing --strict
```

---

**åˆ›å»ºæ—¶é—´**: 2026-01-11 12:08  
**éªŒè¯çŠ¶æ€**: âœ… é€šè¿‡  
**ç­‰å¾…å®¡æ‰¹**: æ˜¯

**è¯·æ‚¨å®¡é˜…ææ¡ˆï¼Œç¡®è®¤åæˆ‘å°†ç«‹å³å¼€å§‹å®æ–½ï¼** ğŸš€
